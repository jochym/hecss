---

title: Core

keywords: fastai
sidebar: home_sidebar

summary: "The core functionality of the HECSS module is provided by the `HECSS` factory function,"
description: "The core functionality of the HECSS module is provided by the `HECSS` factory function,"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="normalize_conf" class="doc_header"><code>normalize_conf</code><a href="https://gitlab.com/jochym/hecss/tree/nbdev/hecss/core.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>normalize_conf</code>(<strong><code>c</code></strong>, <strong><code>base</code></strong>)</p>
</blockquote>

<pre><code>Normalize the configuration `c` relative to the basic structure `base`.
Normalization is performed by "nuwrapping" the displacements of atoms
when they cross the periodic boundary conditions in such a way that the
atoms are not "jumping" from one side of the cell to the other.

E.g. if the atom at r=(0,0,0) goes to the relative position (-0.01, 0, 0)
it is "wrapped" by PBC to the r=(0.99, 0, 0). Thus if we naiively calculate
the displacement we will get a large positive displacement (0.99 of the cell
vector) instead of a small negative one.

This function reverses that process making the positions suitable for
differentiation. The positions may be part of a continous trajectory or
just independent configurations. This makes it impossible for described
procedure to work if the displacements are above 1/2 of the unit cell.
For sefety this implementation is limited to displacements &lt; 1/3 of the
unit cell. If any coordinate changes by more then 1/3 the function
will rise an AssertionError exception.

This implementation is not suitable for tracking positions in the system
with systematic drift (e.g. long MD trajectory with non-perfect momentum
conservation). For stronger implementation suitable for such cases look
at dxutils package.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">allclose</span>

<span class="c1"># Use structure with most of the atoms </span>
<span class="c1"># on the surface of the unit cell: rocksalt</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s1">&#39;NaCl&#39;</span><span class="p">,</span> <span class="s1">&#39;rocksalt&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.6</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s1">&#39;NaCl&#39;</span><span class="p">,</span> <span class="s1">&#39;rocksalt&#39;</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.6</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Displace the atoms</span>
<span class="n">c</span><span class="o">.</span><span class="n">rattle</span><span class="p">(</span><span class="n">stdev</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Store unwrapped positions</span>
<span class="n">unwrapped</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_scaled_positions</span><span class="p">(</span><span class="n">wrap</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Wrap the positions</span>
<span class="n">c</span><span class="o">.</span><span class="n">set_scaled_positions</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">get_scaled_positions</span><span class="p">(</span><span class="n">wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Check if the reversal worked</span>
<span class="k">assert</span> <span class="n">allclose</span><span class="p">(</span><span class="n">unwrapped</span><span class="p">,</span> <span class="n">normalize_conf</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="write_dfset" class="doc_header"><code>write_dfset</code><a href="https://gitlab.com/jochym/hecss/tree/nbdev/hecss/core.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>write_dfset</code>(<strong><code>fn</code></strong>, <strong><code>c</code></strong>)</p>
</blockquote>

<pre><code>Append displacement-force data from the conf to the fn file.
The format is suitable for use as ALAMODE DFSET file.
Optionaly you can provide configuration number in n.
File need not exist prior to first call.
If it does not it will be created.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="HECSS_Sampler-generator-function"><a href="/hecss/core#HECSS_Sampler"><code>HECSS_Sampler</code></a> generator function<a class="anchor-link" href="#HECSS_Sampler-generator-function"> </a></h2><p>The implementation of the core functionality is centered around this generator function which yields samples from the thermal distribution at a given temperature.
This is more flexible but also more advanced technique. For every-day use it is better to employ <a href="/hecss/core#HECSS"><code>HECSS</code></a> class which facilitates more traditional interface and usage patterns using this function under the hood.</p>
<h3 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h3><p>A general usage scheme runs the sampler in the for loop as an iterator providing series of samples.</p>
<ul>
<li><code>N</code>: number of requested samples, </li>
<li><code>cryst</code> : structure to be calculated,</li>
<li><code>calc</code> : ASE calculator</li>
<li><code>T</code>: target temperature in Kelvin.</li>
</ul>
<p>Loop variables:</p>
<ul>
<li><code>n</code> : sample number</li>
<li><code>i</code> : sample configuration index (may not change between samples)</li>
<li><code>x</code> : displacement vector</li>
<li><code>f</code> : forces</li>
<li><code>e</code> : potential energy</li>
</ul>
<p>The minimal main loop should be structured like this:</p>
<div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">HECSS_Sampler</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">calc</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sampler</span><span class="p">:</span>
    <span class="n">process_sample</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">N</span> <span class="p">:</span>
        <span class="k">break</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>This structure is well suited for the interactive use inside the notebook. It is possible in this setup to run few initial iterations to test if all works well and then continue the same loop by just increasing the <code>N</code> variable and re-running the above loop to continue the calculations.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Alternatively, if you know that you need particular number of iterations you can use the <code>N</code> parameter of the sampler to produce a particular number of configurations:</p>
<div class="highlight"><pre><span></span><span class="n">confs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sample</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">HECSS_Sampler</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">calc</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)]</span>
<span class="n">process_samples</span><span class="p">(</span><span class="n">confs</span><span class="p">)</span>
</pre></div>
<p>This setup is better suited to command-line work, but in this case you cannot continue the iterations after the loop finishes.</p>
<p>These are minimal examples. Look at <code>VASP_Tutorial</code> and <code>LAMMPS_Tutorial</code> for more elaborated examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="HECSS_Sampler" class="doc_header"><code>HECSS_Sampler</code><a href="https://gitlab.com/jochym/hecss/tree/nbdev/hecss/core.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>HECSS_Sampler</code>(<strong><code>cryst</code></strong>, <strong><code>calc</code></strong>, <strong><code>T_goal</code></strong>, <strong><code>width</code></strong>=<em><code>1</code></em>, <strong><code>maxburn</code></strong>=<em><code>20</code></em>, <strong><code>N</code></strong>=<em><code>None</code></em>, <strong><code>w_search</code></strong>=<em><code>True</code></em>, <strong><code>delta_sample</code></strong>=<em><code>0.01</code></em>, <strong><code>directory</code></strong>=<em><code>None</code></em>, <strong><code>reuse_base</code></strong>=<em><code>None</code></em>, <strong><code>verb</code></strong>=<em><code>True</code></em>, <strong><code>pbar</code></strong>=<em><code>None</code></em>, <strong><code>priors</code></strong>=<em><code>None</code></em>, <strong><code>posts</code></strong>=<em><code>None</code></em>, <strong><code>width_list</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Run HECS sampler on the system `cryst` using calculator `calc` at target
temperature `T_goal`. The `delta`, `width`, `maxburn` and `directory`
parameters determine detailed aspects of the algorithm.

This is a generator and cannot be used as regular function.
It is intended to be used as a source of the sequence of
configurations in the `for` loop and must be closed after
finishing the iteration. On the other hand, the iteration
may be continued if additional samples are required.
The state is preserved until the .close() method is called.

INPUT
-----
cryst        : ASE structure to sample
calc         : ASE calculator to use for potential energy evaluations
T_goal       : Target temperature in Kelvin
width        : initial width of the position distribution, relative
               to the heurestic value defined inside function
maxburn      : max number of burn-in steps
N            : Number of iterations. If None (default) the generator never stops.
w_search     : Run search for initial w. If false start from whatever
               is passed as width.
delta_sample : Prior width adaptation rate. The default is sufficient in most cases.
directory    : (only for VASP calculator) directory for calculations and generated samples.
               If left as None, the `calc/{T_goal:.1f}K/` will be used and the generated
               samples will be stored in the `smpl/{i:04d}` subdirectories.
reuse_base   : (only for VASP calculator) None or the base calc directory for the ground
               state config. If None the base will be recalculated at the start of the run.
               If directory name - the energy from this dir will be reused as ground state
               energy for the calculation. Be careful to have the same VASP setup in calc
               and reuse_base, otherwise the ground state energy and distribution
               will be wrong.
verb         : print verbose progress messages for interactive use
pbar         : tqdm progress bar object. If None (default) there will be no output.

**Output parameters**

priors       : Output parameter. If not None, store in passed list the sequence of priors.
posts        : Output parameter. If not None, store in passed list the sequence of posteriors.
width_list   : Output parameter. If not None, store in passed list the sequence of widths.

OUTPUT
------
The generator yields samples from the thermodynamic distribution at T=T_goal as tuples
(number, index, displacement, forces, energy):

- number       : sample number, always increasing
- index        : integer numbering the samples in the `smpl` subdirectory. The index may
               repeat if the sample must be repeated in the sequence.
- displacement : set of atomic displacements (in A) in the sample (numpy array)
- forces       : set of forces (in eV/A) generated by the displacement
- energy       : potential energy of the configuration</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="HECSS-class"><a href="/hecss/core#HECSS"><code>HECSS</code></a> class<a class="anchor-link" href="#HECSS-class"> </a></h2><p>Standard interface to the HECSS library. This class encapsulates the actual sampler implemented in the <a href="/hecss/core#HECSS_Sampler"><code>HECSS_Sampler</code></a> generator funtion and provides main functionality of the library through the <code>generate</code> method.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="HECSS" class="doc_header"><code>class</code> <code>HECSS</code><a href="https://gitlab.com/jochym/hecss/tree/nbdev/hecss/core.py#L311" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>HECSS</code>(<strong><code>cryst</code></strong>, <strong><code>calc</code></strong>, <strong><code>T_goal</code></strong>, <strong><code>width</code></strong>=<em><code>1</code></em>, <strong><code>maxburn</code></strong>=<em><code>20</code></em>, <strong><code>N</code></strong>=<em><code>None</code></em>, <strong><code>w_search</code></strong>=<em><code>True</code></em>, <strong><code>delta_sample</code></strong>=<em><code>0.01</code></em>, <strong><code>directory</code></strong>=<em><code>None</code></em>, <strong><code>reuse_base</code></strong>=<em><code>None</code></em>, <strong><code>verb</code></strong>=<em><code>True</code></em>, <strong><code>pbar</code></strong>=<em><code>True</code></em>, <strong><code>priors</code></strong>=<em><code>None</code></em>, <strong><code>posts</code></strong>=<em><code>None</code></em>, <strong><code>width_list</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

<pre><code>Class facilitating more traditional use of the `HECSS_Sampler` generator.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h3><p>After creating <a href="/hecss/core#HECSS"><code>HECSS</code></a> object for the structure, calculator and temperature you call the <code>generate</code> method to obtain a list of samples of a given length.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">import</span> <span class="nn">asap3</span>
<span class="kn">from</span> <span class="nn">hecss.monitor</span> <span class="kn">import</span> <span class="n">plot_stats</span>

<span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;Tersoff_LAMMPS_ErhartAlbe_2005_SiC__MO_903987585848_003&#39;</span>
<span class="n">sys_size</span> <span class="o">=</span> <span class="s1">&#39;3x3x3&#39;</span>
<span class="n">sc</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sys_size</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)]</span>
<span class="n">cryst</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s1">&#39;SiC&#39;</span><span class="p">,</span> <span class="n">crystalstructure</span><span class="o">=</span><span class="s1">&#39;zincblende&#39;</span><span class="p">,</span>
                 <span class="n">a</span><span class="o">=</span><span class="mf">4.38120844</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sc</span><span class="p">))</span>
<span class="n">cryst</span><span class="o">.</span><span class="n">set_calculator</span><span class="p">(</span><span class="n">asap3</span><span class="o">.</span><span class="n">OpenKIMcalculator</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">HECSS</span><span class="p">(</span><span class="n">cryst</span><span class="p">,</span> <span class="n">asap3</span><span class="o">.</span><span class="n">OpenKIMcalculator</span><span class="p">(</span><span class="n">model</span><span class="p">),</span> <span class="n">T</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">plot_stats</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">ase.units</span> <span class="k">as</span> <span class="nn">un</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">])</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="n">_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">])</span>
<span class="n">s_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">un</span><span class="o">.</span><span class="n">kB</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cryst</span><span class="p">))</span>

<span class="c1"># The mean really should be inside target sigma around T</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">un</span><span class="o">.</span><span class="n">kB</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">s_target</span>

<span class="c1"># And sigmas should be within 10% of each other</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s</span><span class="o">/</span><span class="n">s_target</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">--------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-d855ac730690&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">import</span> ase<span class="ansi-blue-fg">.</span>units <span class="ansi-green-fg">as</span> un
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>m <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>mean<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>_<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> _ <span class="ansi-green-fg">in</span> samples<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> s <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>std<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>_<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> _ <span class="ansi-green-fg">in</span> samples<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> s_target <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">/</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">*</span>un<span class="ansi-blue-fg">.</span>kB<span class="ansi-blue-fg">*</span>T<span class="ansi-blue-fg">/</span>np<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span>len<span class="ansi-blue-fg">(</span>cryst<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> 

<span class="ansi-red-fg">NameError</span>: name &#39;samples&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

